<?php/* Add this on all pages on top. */set_include_path($_SERVER['DOCUMENT_ROOT'].'/'.PATH_SEPARATOR.$_SERVER['DOCUMENT_ROOT'].'/library/classes/');/** * Standard includes */require_once 'config/database.php';require_once 'config/smarty.php';/** * Check for login */require_once 'includes/auth.php';/* Other resources. */require_once 'global_functions.php';/* objects. */require_once 'class/participant.php';require_once 'class/participantlogin.php';$participantObject 			= new class_participant();$participantloginObject	= new class_participantlogin();if (isset($_GET['code']) && trim($_GET['code']) != '') {		$code = trim($_GET['code']);		$participantData = $participantObject->getByCode($code);	if(!$participantData) {		header('Location: /participants/view/');		exit;	}	$smarty->assign('participantData', $participantData);	} else {	header('Location: /participants/view/');	exit;}$participantloginData = $participantloginObject->getByParticipant($participantData['participant_code']);if($participantloginData) $smarty->assign('participantloginData', $participantloginData); if(isset($_GET['actioncode'])) {		$errorArray				= array();	$errorArray['error']	= '';	$errorArray['result']	= 0;		$formValid				= true;	$success					= NULL;	$actioncode				= trim($_GET['actioncode']);	$status						= (int)trim($_GET['status']);			if($errorArray['error']  == '' && $errorArray['result']  == 0 ) {		$data	= array();		$data['participantlogin_active'] = $status;				$where = $participantloginObject->getAdapter()->quoteInto('participantlogin_code = ?', $actioncode);		$success	= $participantloginObject->update($data, $where);					if(is_numeric($success) && $success > 0) {			$errorArray['error']	= '';			$errorArray['result']	= 1;					} else {			$errorArray['error']	= 'Could not change status, please try again.';			$errorArray['result']	= 0;						}	}		echo json_encode($errorArray);	exit;}$smarty->display('participants/view/login.tpl');?>